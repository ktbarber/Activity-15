---
title: "Activity #15"
subtitle: "Various data visualizations and what I have learned from Stat 184"
author: "Kyle Barber"
date: "Nov.19, 2025"
date-modified: now
format:
  pdf:
    embed-resources: true
    toc: true
    link-external-newwindow: false
execute: 
  echo: false
  warning: false
csl: https://www.zotero.org/styles/apa
---

{{< pagebreak >}}

## Frequency table of each sex in a specific rank when accounting for all enlisted soldiers in the Army

```{r}
#| label: fig-military-frequency-table
#| fig-cap: "Frequency table of each sex in a specific rank when accounting for all enlisted soldiers in the Army"
#| fig-alt: "Frequency table showing what percent each sex represents in each rank of enlisted soldiers in the Army"
#| fig-pos: "H"
# CODE FOR MILITARY FREQUENCY TABLE
# 1. Load necessary packages: tidyverse, rvest, googlesheets4.
library(tidyverse)
library(rvest)
library(googlesheets4)
library(dplyr)
library(janitor)
library(kableExtra)

# 2. Scrape the Pay Grade and Rank dataset.
PayGrade_rank <- read_html("https://neilhatfield.github.io/Stat184_PayGradeRanks.html")%>%
  html_elements(css = "table")%>%
  html_table()
PayGrade_rank_raw <- PayGrade_rank[[1]]

# 3. Rename the headers of the Pay Grade and Rank dataset.
names(PayGrade_rank_raw) <- c("membership", "Pay_Grade", "Army", "Navy",
                              "Marine.Corps", "Air.Force", "Space.Force",
                              "Coast.Guard")

# 4. Wrangle the Pay Grade and Rank data set.
clean_PayGrade_rank <- PayGrade_rank_raw%>% ## get rid of the first column and row
  select(-membership)%>%
  slice(-1)%>% ## combine all columns besides Pay Grade to represent rank and branch.
  pivot_longer(
    cols = Army:Coast.Guard,
    names_to = "Branch",
    values_to = "Ranks"
  )%>% ## get rid of unnecessary rows
  slice(-(145:150))

# 4. Load in the Armed Forced data
gs4_deauth()
military_Raw <- read_sheet(
  ss = "https://docs.google.com/spreadsheets/d/19xQnI1cBh6Jkw7eP8YQuuicMlVDF7Gr-nXCb5qbwb_E/edit?usp=sharing",
  col_names = TRUE,
  skip = 2,
  na = c("", "N/A*")
)

# 5. Wrangle the Armed Forces data
military_clean <- military_Raw%>% ## get rid of all total columns and rows
  select(!contains("Total"))%>%
  slice(c(-10, -16, -27, -28, -29))%>%
  select(-"Male...17", -"Female...18")%>% ## Rename all male and female columns and provide specific branch.
  rename(
    Army_Male = Male...2,
    Army_Female =  Female...3,
    Navy_Male = Male...5,
    Navy_Female = Female...6,
    Marine.Corps_Male = Male...8,
    Marine.Corps_Female = Female...9,
    Air.Force_Male = Male...11,
    Air.Force_Female = Female...12,
    Space.Force_Male = Male...14,
    Space.Force_Female = Female...15
  )%>% ## create new column combining all columns besides pay grade.
  pivot_longer(
    cols = Army_Male:Space.Force_Female,
    names_to = "Branch_Sex",
    values_to = "frequency"
  )%>% ## separate new column by name and branch.
  separate_wider_delim(
    cols = Branch_Sex,
    names = c("Branch", "Sex"),
    delim = "_"
  )%>% ## Add the ranks
  mutate(
    RankClass = case_when(
      grepl(pattern = "^E", x = `Pay Grade`) ~ "Enlisted",
      grepl(pattern = "^W", x = `Pay Grade`) ~ "Warrant Officer",
      grepl(pattern = "^O", x = `Pay Grade`) ~ "Officer"
    )
  )


# 6. Join tables
final_frequency_table <- left_join(
  x = military_clean,
  y = clean_PayGrade_rank, 
  by = join_by(`Pay Grade` == Pay_Grade, Branch == Branch)
)

# 7. Make case an individual soldier
final_table <- final_frequency_table %>%
  filter(!is.na(frequency)) %>% ## Remove all cases with missing counts
  uncount(
    weights = frequency
  )

# 8. Make the frequency data set
data <- final_table
Frequency_table <- data%>% 
  filter(Branch == "Army" & RankClass == "Enlisted")%>% #Choose which branch and rank class to use
  tabyl(Ranks, Sex)%>% #Choose what frequencies to use
  adorn_totals(where = c("row", "col"))%>% #set totals
  adorn_percentages(denominator = "all")%>% #set percentages
  adorn_pct_formatting(digits = 2) #set format

# 9. Make a frequency table
Frequency_table %>%
  kable( #set caption
    caption = "Frequency table of each sex in a specific rank when accounting for all enlisted soldiers in the Army",
    booktabs = TRUE,
    align = c("l", rep("c", 6))
  ) %>%
  kable_styling( #set style
    bootstrap_options = c("striped", "condensed"),
    font_size = 16
  )
```
@fig-military-frequency-table shows a frequency table showing what percent each sex represents in each rank of enlisted soldiers in the Army.

{{< pagebreak >}}

## Popularity of Baby Names Plot

```{r}
#| label: fig-baby-name-graph
#| fig-cap: "Plot of popularity of various baby names over time"
#| fig-alt: "Line graph of the popularity of four baby names: Kyle, Ryan, Scott and Peter from the time period 1880 to 2013."
#| fig-pos: "H"
# CODE FOR POPULARITY OF BABY NAMES
# 1. Load necessary packages
library(tidyverse)
library(ggplot2)
library(dplyr)
library(dcData)
data(BabyNames)
# 2. Filtering our specific names
Baby_Name <- BabyNames%>%
  filter(name == c("Kyle", "Peter", "Scott", "Ryan"), sex == "M")
# 2. Creating plot
ggplot(Baby_Name) +
  ## Setting the aesthetic
  aes(x = year, y = count, colour = name, linetype = name) +
  geom_line(size = 1.0) +
  scale_color_hue(direction = 1) +
  ## Labeling plot
  labs(
    x = "YEAR",
    y = "COUNT",
  ) +
  ## Setting theme of plot and size of lines
  theme_minimal() +
  theme(
    plot.title = element_text(size = 20L,
                              hjust = 0.5),
    axis.title.y = element_text(size = 15L),
    axis.title.x = element_text(size = 15L)
  )
```
@fig-baby-name-graph demonstrates the popularity of the names: Kyle, Ryan, Scott and Peter. I chose these names because I was curious to see the popularity of the names of myself (Kyle) and my friends (Ryan, Scott and Peter) over time. 

{{< pagebreak >}}

## Code for boxvolume function and plot of the maximum box volume vs height

```{r}
#| label: fig-boxvolume-graph
#| fig-cap: "Plot of maximum box volume vs height using my boxvolume function"
#| fig-alt: "Line graph that shows the maximum volume of a box over various height from 0 to 15."
#| fig-pos: "H"
# CODE FOR BOX PROBLEM
# 1. Load necessary packages
library(ggplot2)
# 2. Function fo find the volume of a box with given length width and height.
boxvolume <- function(length, width, height){
  newLength = length - 2 * height
  newWidth = width  - 2*height
  volume = newLength*newWidth*height
  return(volume)
}

# 3. Plot of maximum box volume vs height of box using my boxvolume function
ggplot()+
  stat_function( ## calling the function
    fun = boxvolume,
    args = list(length = 36, width = 48),
    xlim = c(0, 15)
  ) +
  scale_x_continuous( ## set parameters of the x-axis
    breaks = seq(from = 0, to = 15, by = 1)
  ) + 
  labs( ## labeling the plot
  x = "Height of Box (inches)",
  y = "Maximum Box Volume (inches cubed)"
) +
  theme_minimal() ## set the theme of the plot
```
@fig-boxvolume-graph displays the maximum volume of a box over various height values from 0 to 15. This graph calls a box volume function that calculates the volume of a box when given the length width and height. 
